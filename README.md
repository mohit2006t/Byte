# Node.js URL Shortener

## Description

This project is a simple URL shortening service built with Node.js, Express.js, and SQLite. It allows users to convert long URLs into shorter, more manageable links. These short links, when accessed, redirect the user to the original long URL. The service provides a web interface for shortening URLs and API endpoints for programmatic access.

## Technologies Used

*   **Node.js:** JavaScript runtime environment.
*   **Express.js:** Web application framework for Node.js.
*   **SQLite3:** Embedded SQL database engine.

## Prerequisites

Before you begin, ensure you have Node.js and npm (Node Package Manager) installed on your system. You can check their versions by running:

```bash
node -v
npm -v
```

If they are not installed, please download and install them from [nodejs.org](https://nodejs.org/).

## Setup and Installation

1.  **Clone the Repository (if applicable):**
    If you have downloaded this project as a zip or are cloning it from a Git repository:
    ```bash
    # git clone <repository_url>
    # cd <project_directory>
    ```
    (For the current development environment, the code is already present.)

2.  **Install Dependencies:**
    Navigate to the project's root directory in your terminal and run:
    ```bash
    npm install
    ```
    This command will install all the necessary packages defined in `package.json`, including Express.js and SQLite3.

3.  **Set Up the Database:**
    After installing dependencies, run the database setup script:
    ```bash
    node database_setup.js
    ```
    This script will create a `database.sqlite` file in the project root and set up the required `urls` table. You should see success messages in your console.

## Running the Application

Once the setup and installation are complete, you can start the server:

```bash
node server.js
```

By default, the application will be running and accessible at `http://localhost:3000`. You will see a confirmation message in your console indicating the port it's running on (e.g., `Server running on port 3000`).

### Environment Variables

You can customize the server's host and port using environment variables:

*   **`PORT`**:
    *   Controls the port on which the server listens.
    *   Defaults to `3000` if not set.
    *   Example: `PORT=8080 node server.js`

*   **`HOST`**:
    *   Determines the hostname used in the generated short URLs. This is useful if the application is behind a reverse proxy or you want to enforce a specific domain.
    *   If not set, the application will attempt to use the `Host` header from the incoming HTTP request.
    *   If the `Host` header is also unavailable, it defaults to `localhost`.
    *   Example: `HOST=my-url-shortener.com node server.js`

You can use them together:

```bash
HOST=my-url-shortener.com PORT=80 node server.js
```
This would make the server listen on port 80 and generate short URLs like `http://my-url-shortener.com/xxxxxx`.

If only `HOST` is provided (e.g., `HOST=my-custom-domain.com node server.js`), the server will use the default port `3000` (or the port from `req.headers.host` if available for listening, though typically `PORT` env var takes precedence for listening port). The generated URLs will use `my-custom-domain.com`.

## How to Use

### Web Interface

1.  Open your web browser and navigate to `http://localhost:3000`.
2.  You will see a form with an input field labeled "Enter long URL".
3.  Paste your long URL into the field and click the "Shorten" button.
4.  The shortened URL will be displayed below the form (e.g., `http://localhost:3000/xxxxxx`).
5.  You can click this link or copy and paste it into your browser's address bar. Accessing this short URL will redirect you to the original long URL you provided.

### API Endpoints

The service also provides the following API endpoints:

#### `POST /shorten`

*   **Description:** Creates a new short URL for a given long URL.
*   **Request Body:** JSON object containing the long URL.
    ```json
    {
        "long_url": "https://www.example.com/very/long/url/to/shorten"
    }
    ```
*   **Response (Success - 201 Created):** JSON object containing the shortened URL.
    ```json
    {
        "short_url": "http://localhost:3000/abcdefg"
    }
    ```
*   **Response (Error - 400 Bad Request):** If `long_url` is missing or invalid.
    ```json
    {
        "error": "Missing long_url in request body"
    }
    ```
    or
    ```json
    {
        "error": "Invalid URL format"
    }
    ```
*   **Response (Error - 500 Internal Server Error):** If there's a server-side issue (e.g., database error, failure to generate a unique code).

#### `GET /:short_code`

*   **Description:** Redirects to the original long URL associated with the `short_code`.
*   **URL Parameter:** `short_code` - The unique identifier generated by the `/shorten` endpoint.
*   **Example:** `http://localhost:3000/abcdefg`
*   **Response (Success - 301 Moved Permanently):** Redirects the client to the original long URL.
*   **Response (Error - 404 Not Found):** If the `short_code` does not exist in the database.
    ```json
    {
        "error": "Short URL not found"
    }
    ```
*   **Response (Error - 500 Internal Server Error):** If there's a server-side database issue.

## Project Structure

```
.
├── public/
│   └── index.html        # Frontend HTML and JavaScript
├── database.sqlite       # SQLite database file (created by database_setup.js)
├── database_setup.js     # Script to initialize the database and table
├── server.js             # Express server, API logic, static file serving
├── package.json          # Project metadata and dependencies
├── package-lock.json     # Records exact versions of dependencies
└── README.md             # This file
```
